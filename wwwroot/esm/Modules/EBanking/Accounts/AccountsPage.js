import{a as v,b as w,c as d,d as p,e as C}from"../../../_chunks/chunk-WRYVWBYB.js";import{a as y}from"../../../_chunks/chunk-O75CA257.js";import{a as c,b as B,c as h,d as f,f as I,g as k}from"../../../_chunks/chunk-BX2ZHUFS.js";var P=B((O,E)=>{E.exports=Serenity.Extensions});var U=h(k(),1);var u=h(I(),1);var o=h(I(),1);var l=class extends o.EntityDialog{constructor(){super(...arguments);this.form=new w(this.idPrefix)}getFormKey(){return w.formKey}getRowDefinition(){return d}getService(){return p.baseUrl}getToolbarButtons(){let e=super.getToolbarButtons();return this.entity&&this.entity.AccountId&&e.forEach(i=>{i.visible=!1}),e}updateInterface(){super.updateInterface(),this.isEditMode()&&(o.EditorUtils.setReadOnly(this.form.Balance,!0),o.EditorUtils.setReadOnly(this.form.AccountType,!0),o.EditorUtils.setReadOnly(this.form.OpenDate,!0),o.EditorUtils.setReadOnly(this.form.CustomerId,!0),this.deleteButton.hide(),this.applyChangesButton.hide(),this.saveAndCloseButton.hide())}};c(l,"AccountsDialog"),l=f([o.Decorators.registerClass("cyberbanking.EBanking.AccountsDialog")],l);var t=h(k(),1);var x=h(P(),1);var a=class extends u.EntityGrid{constructor(e){super(e)}getColumnsKey(){return v.columnsKey}getDialogType(){return l}getRowDefinition(){return d}getService(){return p.baseUrl}createToolbarExtensions(){super.createToolbarExtensions(),t.Authorization.hasPermission(C.Security)&&(this.rowSelection=new u.GridRowSelectionMixin(this))}getButtons(){let e=super.getButtons();return t.Authorization.hasPermission(C.Security)&&(e.splice(0,1),e.push({title:"Activate Accounts",icon:"fa fa-check",visible:!0,cssClass:"add-button",onClick:i=>{let r=this.rowSelection.getSelectedKeys();if(r.length>0){var n=new S;n.done=()=>this.rowSelection.resetCheckedAndRefresh(),n.execute(r)}else(0,t.notifyError)("Please Select Rows to submit")}}),e.push({title:"Deactivate Accounts",icon:"fa fa-ban",visible:!0,cssClass:"delete-button",onClick:i=>{let r=this.rowSelection.getSelectedKeys();if(r.length>0){var n=new m;n.done=()=>this.rowSelection.resetCheckedAndRefresh(),n.execute(r)}else(0,t.notifyError)("Please Select Rows to submit")}})),e}getColumns(){let e=super.getColumns(),i=(0,t.first)(e,r=>r.field==d.Fields.CustomerUsername);return t.Authorization.hasPermission(C.Security)&&(e.splice(0,0,u.GridRowSelectionMixin.createSelectColumn(()=>this.rowSelection)),i.visible=!0),e}usePager(){return!0}getQuickFilters(){var r,n,R;let e=super.getQuickFilters();t.Authorization.hasPermission(C.Security)||e.splice((0,t.indexOf)(e,g=>g.field==d.Fields.CustomerUsername),1);let i=(n=(0,t.tryFirst)((r=y.getLookup())==null?void 0:r.items,g=>g.Username==="admin"))==null?void 0:n.UserId.toString();return i&&((R=y.getLookup())==null||R.items.splice((0,t.indexOf)(y.getLookup().items,g=>g.UserId.toString()===i),1)),e}};c(a,"AccountsGrid"),a=f([u.Decorators.registerClass("cyberbanking.EBanking.AccountsGrid")],a);var m=class extends x.BulkServiceAction{getParallelRequests(){return 10}getBatchSize(){return 5}sccss(){alert("sccss");debugger}executeForBatch(s){p.DeactivateList({AccountIds:s.map(e=>(0,t.parseInteger)(e))},e=>{this.set_successCount(this.get_successCount()+s.length)},{blockUI:!1,onError:e=>this.set_errorCount(this.get_errorCount()+s.length),onCleanup:()=>this.serviceCallCleanup()})}};c(m,"DeactivateBulkAction"),m=f([u.Decorators.registerClass("cyberbanking.EBanking.DeleteBulkAction")],m);var S=class extends x.BulkServiceAction{getParallelRequests(){return 10}getBatchSize(){return 5}sccss(){alert("sccss");debugger}executeForBatch(s){p.ActivateList({AccountIds:s.map(e=>(0,t.parseInteger)(e))},e=>{this.set_successCount(this.get_successCount()+s.length)},{blockUI:!1,onError:e=>this.set_errorCount(this.get_errorCount()+s.length),onCleanup:()=>this.serviceCallCleanup()})}};c(S,"ActivateBulkAction");function A(){(0,U.initFullHeightGridPage)(new a($("#GridDiv")).element)}c(A,"pageInit");export{A as default};
//# sourceMappingURL=AccountsPage.js.map
