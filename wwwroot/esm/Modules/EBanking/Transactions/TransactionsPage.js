import{e as T,f as A,g as F,h as a,i as R}from"../../../_chunks/chunk-SUCL7J3Q.js";import{a as i}from"../../../_chunks/chunk-4MAJQGUF.js";import{a as m,b as l,c as U,e as x,f as k}from"../../../_chunks/chunk-ZR7A2VZA.js";var L=l(k(),1);var S=l(x(),1);var n=l(x(),1);var u=l(k(),1),w=l(k(),1);var d=class extends n.EntityDialog{constructor(){super(...arguments);this.form=new F(this.idPrefix)}getFormKey(){return F.formKey}getRowDefinition(){return a}getService(){return R.baseUrl}afterLoadEntity(){var f,g,y,h;super.afterLoadEntity(),this.form.TransactionType.changeSelect2(o=>{let I=(0,u.toId)(this.form.TransactionType.value);this.form.ReceiverAccountId.getGridField().toggle(I===3)});let r=(g=(0,u.tryFirst)((f=i.getLookup())==null?void 0:f.items,o=>o.Username===w.Authorization.username))==null?void 0:g.UserId.toString(),c=(h=(0,u.tryFirst)((y=i.getLookup())==null?void 0:y.items,o=>o.Username==="admin"))==null?void 0:h.UserId.toString();r!==c&&this.form.ReceiverAccountId.items.splice((0,u.indexOf)(this.form.ReceiverAccountId.items,o=>o.id===r),1)}updateInterface(){super.updateInterface(),this.isEditMode()&&(n.EditorUtils.setReadOnly(this.form.ReceiverAccountId,!0),n.EditorUtils.setReadOnly(this.form.TransactionType,!0),n.EditorUtils.setReadOnly(this.form.Amount,!0),n.EditorUtils.setReadOnly(this.form.Description,!0),this.deleteButton.hide(),this.applyChangesButton.hide(),this.saveAndCloseButton.hide())}};m(d,"TransactionsDialog"),d=U([n.Decorators.registerClass("cyberbanking.EBanking.TransactionsDialog")],d);var t=l(k(),1);var p=class extends S.EntityGrid{getColumnsKey(){return A.columnsKey}getDialogType(){return d}getRowDefinition(){return a}getService(){return R.baseUrl}constructor(e){super(e)}getQuickFilters(){var f,g,y,h,o,I,v;let e=super.getQuickFilters();t.Authorization.hasPermission(T.Security)||e.splice((0,t.indexOf)(e,s=>s.field==a.Fields.SenderAccountId),1);let r=(g=(0,t.tryFirst)((f=i.getLookup())==null?void 0:f.items,s=>s.Username==="admin"))==null?void 0:g.UserId,c=(y=(0,t.tryFirst)(i.getLookup().items,s=>s.Username===t.Authorization.username))==null?void 0:y.UserId;return r&&((o=i.getLookup())==null||o.items.splice((0,t.indexOf)((h=i.getLookup())==null?void 0:h.items,s=>s.UserId===r),1)),c!==r&&((v=i.getLookup())==null||v.items.splice((0,t.indexOf)((I=i.getLookup())==null?void 0:I.items,s=>s.UserId===c),1)),e}getQuickSearchFields(){let e=a.Fields,r=m(c=>(0,t.text)(`Db.${a.localTextPrefix}.${c}`).toLowerCase(),"txt");return[{name:"",title:"all"},{name:e.Description,title:r(e.Description)},{name:e.Amount,title:r(e.Amount)}]}getButtons(){let e=super.getButtons();return t.Authorization.hasPermission(T.Security)&&e.splice(0,1),e}getColumns(){let e=super.getColumns(),r=(0,t.first)(e,c=>c.field==a.Fields.SenderAccountId);return t.Authorization.hasPermission(T.Security)||(r.visible=!1),e}};m(p,"TransactionsGrid"),p=U([S.Decorators.registerClass("cyberbanking.EBanking.TransactionsGrid")],p);function b(){(0,L.initFullHeightGridPage)(new p($("#GridDiv")).element)}m(b,"pageInit");export{b as default};
//# sourceMappingURL=TransactionsPage.js.map
