import{e as y,f as k,g as R,h as n,i as h}from"../../../_chunks/chunk-PKELFUWV.js";import{a}from"../../../_chunks/chunk-4MAJQGUF.js";import{a as c,b as l,c as f,e as T,f as g}from"../../../_chunks/chunk-ZR7A2VZA.js";var F=l(g(),1);var I=l(T(),1);var i=l(T(),1);var d=l(g(),1),v=l(g(),1);var m=class extends i.EntityDialog{constructor(){super(...arguments);this.form=new R(this.idPrefix)}getFormKey(){return R.formKey}getRowDefinition(){return n}getService(){return h.baseUrl}afterLoadEntity(){var s,S;super.afterLoadEntity(),this.form.TransactionType.changeSelect2(p=>{let x=(0,d.toId)(this.form.TransactionType.value);this.form.ReceiverAccountId.getGridField().toggle(x===2)});let r=(s=(0,d.tryFirst)(a.getLookup().items,p=>p.Username===v.Authorization.username))==null?void 0:s.UserId.toString(),o=(S=(0,d.tryFirst)(a.getLookup().items,p=>p.Username==="admin"))==null?void 0:S.UserId.toString();r!==o&&this.form.ReceiverAccountId.items.splice((0,d.indexOf)(this.form.ReceiverAccountId.items,p=>p.id===r),1)}updateInterface(){super.updateInterface(),this.isEditMode()&&(i.EditorUtils.setReadOnly(this.form.ReceiverAccountId,!0),i.EditorUtils.setReadOnly(this.form.TransactionType,!0),i.EditorUtils.setReadOnly(this.form.Amount,!0),i.EditorUtils.setReadOnly(this.form.Description,!0),this.deleteButton.hide(),this.applyChangesButton.hide(),this.saveAndCloseButton.hide())}};c(m,"TransactionsDialog"),m=f([i.Decorators.registerClass("cyberbanking.EBanking.TransactionsDialog")],m);var t=l(g(),1);var u=class extends I.EntityGrid{getColumnsKey(){return k.columnsKey}getDialogType(){return m}getRowDefinition(){return n}getService(){return h.baseUrl}constructor(e){super(e)}getQuickFilters(){var o;let e=super.getQuickFilters();t.Authorization.hasPermission(y.Security)||e.splice((0,t.indexOf)(e,s=>s.field==n.Fields.ReceiverAccountId),1);let r=(o=(0,t.tryFirst)(a.getLookup().items,s=>s.Username==="admin"))==null?void 0:o.UserId.toString();return r&&a.getLookup().items.splice((0,t.indexOf)(a.getLookup().items,s=>s.UserId.toString()===r),1),e}getQuickSearchFields(){let e=n.Fields,r=c(o=>(0,t.text)(`Db.${n.localTextPrefix}.${o}`).toLowerCase(),"txt");return[{name:"",title:"all"},{name:e.Description,title:r(e.Description)},{name:e.Amount,title:r(e.Amount)}]}getButtons(){let e=super.getButtons();return t.Authorization.hasPermission(y.Security),e}getColumns(){let e=super.getColumns(),r=(0,t.first)(e,o=>o.field==n.Fields.SenderAccountId);return t.Authorization.hasPermission(y.Security)&&(r.visible=!0),e}};c(u,"TransactionsGrid"),u=f([I.Decorators.registerClass("cyberbanking.EBanking.TransactionsGrid")],u);function A(){(0,F.initFullHeightGridPage)(new u($("#GridDiv")).element)}c(A,"pageInit");export{A as default};
//# sourceMappingURL=TransactionsPage.js.map
